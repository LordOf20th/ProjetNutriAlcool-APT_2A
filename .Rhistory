setwd("C:/Users/lordo/Nextcloud/Documents/APT/2A/SIMM/Stats/Projet")
library(ggplot2)
inca2 <- read.csv('inca2_alcool.csv', header = TRUE)
str(inca2)
inca2$nomen = as.factor(inca2$nomen)
inca2$sexe_ps = as.factor(inca2$sexe_ps)
levels(inca2$sexe_ps) <- c("homme", "femme")
inca2$reg = as.factor(inca2$reg)
levels(inca2$reg) <- c('Nord Ouest', 'Est', 'Ile de France',
'Ouest', 'Centre', 'Centre Est',
'Sud Ouest', 'Sud Est')
summary(inca2)
colnames(inca2)[19:54] <- c("energie_totale","proteines", "glucides_dispos",
"lipides","alcool","ag_monoinsatures",
"ag_polyinsatures", "ag_satures", "amidon",
"glucides_simples","fibres","cholesterol","eau",
"calcium", "fer", "sodium", "magnesium",
"manganese", "phosphore", "potassium",
"cuivre", "zinc", "selenium", "iode",
"retinol", "beta-carotene", "vitamineC",
"vitamineD", "vitamineE", "thiamine-B1",
"riboflavine-B2", "niacine-B3",
"acide_panthothenique-B5", "pyridoxine-B6",
"folates-B9", "colobamine-B12")
knitr::opts_chunk$set(echo = TRUE)
str(inca2)
summary(inca2)
## Résumé des données
```{r}
knitr::kable(summary(inca2))
summary(inca2)
conso <- read.csv(file = 'conso_alcool.csv')
summary(conso)
View(inca2)
View(conso)
View(conso)
conso$nomen = as.factor(conso$nomen)
conso$nomjour = as.factor(conso$nomjour)
conso$nomgr = as.factor(conso$nomgr)
summary(conso)
## Analyse en composante principale
kable(head(inca2))
rm(list=ls())
library(knitr) #pour avoir un format table dans les sorties
library(ggplot2) #pour avoir de 'beaux'graphiques
library(FactoMineR) #pour effectuer l'ACP
library(factoextra) #pour extraire et visualiser les résultats issus de FactoMineR
library(corrplot) #pour avoir une représentation des corrélations
## Import et formattage des données
inca2 <- read.csv('inca2_alcool.csv', header = TRUE)
inca2$nomen = as.factor(inca2$nomen)
inca2$sexe_ps = as.factor(inca2$sexe_ps)
levels(inca2$sexe_ps) <- c("homme", "femme")
inca2$reg = as.factor(inca2$reg)
levels(inca2$reg) <- c('Nord Ouest', 'Est', 'Ile de France',
'Ouest', 'Centre', 'Centre Est',
'Sud Ouest', 'Sud Est')
colnames(inca2)[19:54] <- c("energie_totale","proteines", "glucides_dispos",
"lipides","alcool","ag_monoinsatures",
"ag_polyinsatures", "ag_satures", "amidon",
"glucides_simples","fibres","cholesterol","eau",
"calcium", "fer", "sodium", "magnesium",
"manganese", "phosphore", "potassium",
"cuivre", "zinc", "selenium", "iode",
"retinol", "beta-carotene", "vitamineC",
"vitamineD", "vitamineE", "thiamine-B1",
"riboflavine-B2", "niacine-B3",
"acide_panthothenique-B5", "pyridoxine-B6",
"folates-B9", "colobamine-B12")
summary(inca2)
str(inca2)
conso <- read.csv(file = 'conso_alcool.csv')
conso$nomen = as.factor(conso$nomen)
conso$nomjour = as.factor(conso$nomjour)
conso$nomgr = as.factor(conso$nomgr)
summary(conso)
## Analyse en composante principale
kable(head(inca2))
## Analyse en composante principale
kable(head(inca2))
correlation = cor(inca2)
## Analyse en composante principale
head(inca2)
summary(inca2)
## Analyse en composante principale
head(inca2[-c(1,2,5)])
## Analyse en composante principale
inca2_numerique = inca2[-c(1,2,5)]
correlation = cor(inca2_numerique)
rm(list=ls())
library(knitr) #pour avoir un format table dans les sorties
library(ggplot2) #pour avoir de 'beaux'graphiques
library(FactoMineR) #pour effectuer l'ACP
library(factoextra) #pour extraire et visualiser les résultats issus de FactoMineR
library(corrplot) #pour avoir une représentation des corrélations
## Import et formattage des données
inca2 <- read.csv('inca2_alcool.csv', header = TRUE)
inca2$nomen = as.factor(inca2$nomen)
inca2$sexe_ps = as.factor(inca2$sexe_ps)
levels(inca2$sexe_ps) <- c("homme", "femme")
inca2$reg = as.factor(inca2$reg)
levels(inca2$reg) <- c('Nord Ouest', 'Est', 'Ile de France',
'Ouest', 'Centre', 'Centre Est',
'Sud Ouest', 'Sud Est')
colnames(inca2)[19:54] <- c("energie_totale","proteines", "glucides_dispos",
"lipides","alcool","ag_monoinsatures",
"ag_polyinsatures", "ag_satures", "amidon",
"glucides_simples","fibres","cholesterol","eau",
"calcium", "fer", "sodium", "magnesium",
"manganese", "phosphore", "potassium",
"cuivre", "zinc", "selenium", "iode",
"retinol", "beta-carotene", "vitamineC",
"vitamineD", "vitamineE", "thiamine-B1",
"riboflavine-B2", "niacine-B3",
"acide_panthothenique-B5", "pyridoxine-B6",
"folates-B9", "colobamine-B12")
summary(inca2)
str(inca2)
conso <- read.csv(file = 'conso_alcool.csv')
conso$nomen = as.factor(conso$nomen)
conso$nomjour = as.factor(conso$nomjour)
conso$nomgr = as.factor(conso$nomgr)
summary(conso)
## Analyse en composante principale
inca2_numerique = inca2[-c(1,2,5)]
correlation_inca2 = cor(inca2_numerique)
View(correlation_inca2)
View(correlation_inca2)
corrplot(inca2_numerique)
corrplot(correlation_inca2)
inca2_pca = PCA(inca2_numerique, scale.unit = TRUE)
rm(list=ls())
library(knitr) #pour avoir un format table dans les sorties
library(ggplot2) #pour avoir de 'beaux'graphiques
library(FactoMineR) #pour effectuer l'ACP
library(factoextra) #pour extraire et visualiser les résultats issus de FactoMineR
library(corrplot) #pour avoir une représentation des corrélations
## Import et formattage des données
inca2 <- read.csv('inca2_alcool.csv', header = TRUE)
inca2$nomen = as.factor(inca2$nomen)
inca2$sexe_ps = as.factor(inca2$sexe_ps)
levels(inca2$sexe_ps) <- c("homme", "femme")
inca2$reg = as.factor(inca2$reg)
levels(inca2$reg) <- c('Nord Ouest', 'Est', 'Ile de France',
'Ouest', 'Centre', 'Centre Est',
'Sud Ouest', 'Sud Est')
colnames(inca2)[19:54] <- c("energie_totale","proteines", "glucides_dispos",
"lipides","alcool","ag_monoinsatures",
"ag_polyinsatures", "ag_satures", "amidon",
"glucides_simples","fibres","cholesterol","eau",
"calcium", "fer", "sodium", "magnesium",
"manganese", "phosphore", "potassium",
"cuivre", "zinc", "selenium", "iode",
"retinol", "beta-carotene", "vitamineC",
"vitamineD", "vitamineE", "thiamine-B1",
"riboflavine-B2", "niacine-B3",
"acide_panthothenique-B5", "pyridoxine-B6",
"folates-B9", "colobamine-B12")
summary(inca2)
str(inca2)
conso <- read.csv(file = 'conso_alcool.csv')
conso$nomen = as.factor(conso$nomen)
conso$nomjour = as.factor(conso$nomjour)
conso$nomgr = as.factor(conso$nomgr)
summary(conso)
## Analyse en composante principale
inca2_numerique = inca2[-c(1,2,4,5)]
correlation_inca2 = cor(inca2_numerique)
corrplot(correlation_inca2)
inca2_pca = PCA(inca2_numerique, scale.unit = TRUE)
summary(inca2_pca)
corr_simple <- function(data=df,sig=0.5){
#convert data to numeric in order to run correlations
#convert to factor first to keep the integrity of the data - each value will become a number rather than turn into NA
df_cor <- data %>% mutate_if(is.character, as.factor)
df_cor <- df_cor %>% mutate_if(is.factor, as.numeric)  #run a correlation and drop the insignificant ones
corr <- cor(df_cor)
#prepare to drop duplicates and correlations of 1
corr[lower.tri(corr,diag=TRUE)] <- NA
#drop perfect correlations
corr[corr == 1] <- NA   #turn into a 3-column table
corr <- as.data.frame(as.table(corr))
#remove the NA values from above
corr <- na.omit(corr)   #select significant values
corr <- subset(corr, abs(Freq) > sig)
#sort by highest correlation
corr <- corr[order(-abs(corr$Freq)),]   #print table
print(corr)  #turn corr back into matrix in order to plot with corrplot
mtx_corr <- reshape2::acast(corr, Var1~Var2, value.var="Freq")
#plot correlations visually
corrplot(mtx_corr, is.corr=FALSE, tl.col="black", na.label=" ")
}corr_simple()
inca2_numerique <- inca2 %>% mutate_if(is.character, as.factor)
library(tidyverse)
rm(list=ls())
library(knitr) #pour avoir un format table dans les sorties
library(ggplot2) #pour avoir de 'beaux'graphiques
library(FactoMineR) #pour effectuer l'ACP
library(factoextra) #pour extraire et visualiser les résultats issus de FactoMineR
library(tidyverse)
library(corrplot) #pour avoir une représentation des corrélations
## Import et formattage des données
inca2 <- read.csv('inca2_alcool.csv', header = TRUE)
inca2$nomen = as.factor(inca2$nomen)
inca2$sexe_ps = as.factor(inca2$sexe_ps)
levels(inca2$sexe_ps) <- c("homme", "femme")
inca2$reg = as.factor(inca2$reg)
levels(inca2$reg) <- c('Nord Ouest', 'Est', 'Ile de France',
'Ouest', 'Centre', 'Centre Est',
'Sud Ouest', 'Sud Est')
colnames(inca2)[19:54] <- c("energie_totale","proteines", "glucides_dispos",
"lipides","alcool","ag_monoinsatures",
"ag_polyinsatures", "ag_satures", "amidon",
"glucides_simples","fibres","cholesterol","eau",
"calcium", "fer", "sodium", "magnesium",
"manganese", "phosphore", "potassium",
"cuivre", "zinc", "selenium", "iode",
"retinol", "beta-carotene", "vitamineC",
"vitamineD", "vitamineE", "thiamine-B1",
"riboflavine-B2", "niacine-B3",
"acide_panthothenique-B5", "pyridoxine-B6",
"folates-B9", "colobamine-B12")
summary(inca2)
str(inca2)
conso <- read.csv(file = 'conso_alcool.csv')
conso$nomen = as.factor(conso$nomen)
conso$nomjour = as.factor(conso$nomjour)
conso$nomgr = as.factor(conso$nomgr)
summary(conso)
## Analyse en composante principale
inca2_numerique_reduit = inca2[-c(1,2,4,5)]
inca2_numerique <- inca2 %>% mutate_if(is.character, as.factor)
inca2_numerique <- inca2_numerique %>% mutate_if(is.factor, as.numeric)
correlation_inca2 = cor(inca2_numerique)
corrplot(correlation_inca2)
inca2_pca = PCA(inca2_numerique, scale.unit = TRUE)
summary(inca2_pca)
inca2_numerique <- inca2_numerique %>% mutate_if(is.factor, as.numeric)
inca2_numerique
rm(list=ls())
library(knitr) #pour avoir un format table dans les sorties
library(ggplot2) #pour avoir de 'beaux'graphiques
library(FactoMineR) #pour effectuer l'ACP
library(factoextra) #pour extraire et visualiser les résultats issus de FactoMineR
library(tidyverse)
library(corrplot) #pour avoir une représentation des corrélations
## Import et formattage des données
inca2 <- read.csv('inca2_alcool.csv', header = TRUE)
inca2$nomen = as.factor(inca2$nomen)
inca2$sexe_ps = as.factor(inca2$sexe_ps)
levels(inca2$sexe_ps) <- c("homme", "femme")
inca2$reg = as.factor(inca2$reg)
levels(inca2$reg) <- c('Nord Ouest', 'Est', 'Ile de France',
'Ouest', 'Centre', 'Centre Est',
'Sud Ouest', 'Sud Est')
colnames(inca2)[19:54] <- c("energie_totale","proteines", "glucides_dispos",
"lipides","alcool","ag_monoinsatures",
"ag_polyinsatures", "ag_satures", "amidon",
"glucides_simples","fibres","cholesterol","eau",
"calcium", "fer", "sodium", "magnesium",
"manganese", "phosphore", "potassium",
"cuivre", "zinc", "selenium", "iode",
"retinol", "beta-carotene", "vitamineC",
"vitamineD", "vitamineE", "thiamine-B1",
"riboflavine-B2", "niacine-B3",
"acide_panthothenique-B5", "pyridoxine-B6",
"folates-B9", "colobamine-B12")
summary(inca2)
str(inca2)
conso <- read.csv(file = 'conso_alcool.csv')
conso$nomen = as.factor(conso$nomen)
conso$nomjour = as.factor(conso$nomjour)
conso$nomgr = as.factor(conso$nomgr)
summary(conso)
## Analyse en composante principale
inca2_numerique= inca2[-c(1,2,4,5)]
correlation_inca2 = cor(inca2_numerique)
corrplot(correlation_inca2)
inca2_pca = PCA(inca2_numerique, scale.unit = TRUE)
summary(inca2_pca)
summary(inca2_pca)
get_eigenvalie(inca2_pca)
get_eigenvalue(inca2_pca)
rm(list=ls())
library(knitr) #pour avoir un format table dans les sorties
library(ggplot2) #pour avoir de 'beaux'graphiques
library(FactoMineR) #pour effectuer l'ACP
library(factoextra) #pour extraire et visualiser les résultats issus de FactoMineR
library(tidyverse)
library(corrplot) #pour avoir une représentation des corrélations
## Import et formattage des données
inca2 <- read.csv('inca2_alcool.csv', header = TRUE)
inca2$nomen = as.factor(inca2$nomen)
inca2$sexe_ps = as.factor(inca2$sexe_ps)
levels(inca2$sexe_ps) <- c("homme", "femme")
inca2$reg = as.factor(inca2$reg)
levels(inca2$reg) <- c('Nord Ouest', 'Est', 'Ile de France',
'Ouest', 'Centre', 'Centre Est',
'Sud Ouest', 'Sud Est')
colnames(inca2)[19:54] <- c("energie_totale","proteines", "glucides_dispos",
"lipides","alcool","ag_monoinsatures",
"ag_polyinsatures", "ag_satures", "amidon",
"glucides_simples","fibres","cholesterol","eau",
"calcium", "fer", "sodium", "magnesium",
"manganese", "phosphore", "potassium",
"cuivre", "zinc", "selenium", "iode",
"retinol", "beta-carotene", "vitamineC",
"vitamineD", "vitamineE", "thiamine-B1",
"riboflavine-B2", "niacine-B3",
"acide_panthothenique-B5", "pyridoxine-B6",
"folates-B9", "colobamine-B12")
summary(inca2)
str(inca2)
conso <- read.csv(file = 'conso_alcool.csv')
conso$nomen = as.factor(conso$nomen)
conso$nomjour = as.factor(conso$nomjour)
conso$nomgr = as.factor(conso$nomgr)
summary(conso)
## Analyse en composante principale
inca2_numerique= inca2[-c(1,2,4,5)]
correlation_inca2 = cor(inca2_numerique)
corrplot(correlation_inca2)
inca2_pca = PCA(inca2_numerique, scale.unit = TRUE)
get_eigenvalue(inca2_pca)
fviz_eig(inca2_pca)
kable(get_eigenvalue(inca2_pca))
fviz_eig(inca2_pca)
colnames(inca2_numerique)
colnames(inca2_numerique)[c(1:14)]
colnames(inca2_numerique)[c(1:14,19)]
inca2_numerique[c(1:14,19)]
### Analyse en sous blocs
#### Sous bloc 1 : Age, conso alcool, jour et type
inca2_alcool_par_jour_type <- inca2_numerique[c(1:14,19)]
correlation_inca2_bloc1 = cor(inca2_bloc1)
### Analyse en sous blocs
#### Sous bloc 1 : Age, conso alcool, jour et type
inca2_bloc1 <- inca2_numerique[c(1:14,19)]
correlation_inca2_bloc1 = cor(inca2_bloc1)
inca2_bloc1_pca = PCA(inca2_bloc1, scale.unit = TRUE)
corrplot(correlation_inca2_bloc1)
colnames(inca2)[19:54] <- c("energie_totale/j","proteines", "glucides_dispos",
"lipides","alcool","ag_monoinsatures",
"ag_polyinsatures", "ag_satures", "amidon",
"glucides_simples","fibres","cholesterol","eau",
"calcium", "fer", "sodium", "magnesium",
"manganese", "phosphore", "potassium",
"cuivre", "zinc", "selenium", "iode",
"retinol", "beta-carotene", "vitamineC",
"vitamineD", "vitamineE", "thiamine-B1",
"riboflavine-B2", "niacine-B3",
"acide_panthothenique-B5", "pyridoxine-B6",
"folates-B9", "colobamine-B12")
colnames(inca2)[19:54] <- c("energie_totale/j","proteines", "glucides_dispos",
"lipides","alcool/j","ag_monoinsatures",
"ag_polyinsatures", "ag_satures", "amidon",
"glucides_simples","fibres","cholesterol","eau",
"calcium", "fer", "sodium", "magnesium",
"manganese", "phosphore", "potassium",
"cuivre", "zinc", "selenium", "iode",
"retinol", "beta-carotene", "vitamineC",
"vitamineD", "vitamineE", "thiamine-B1",
"riboflavine-B2", "niacine-B3",
"acide_panthothenique-B5", "pyridoxine-B6",
"folates-B9", "colobamine-B12")
summary(inca2)
str(inca2)
conso <- read.csv(file = 'conso_alcool.csv')
conso$nomen = as.factor(conso$nomen)
conso$nomjour = as.factor(conso$nomjour)
conso$nomgr = as.factor(conso$nomgr)
summary(conso)
## Analyse en composante principale
inca2_numerique = inca2[-c(1,2,4,5)]
correlation_inca2 = cor(inca2_numerique)
corrplot(correlation_inca2)
inca2_pca = PCA(inca2_numerique, scale.unit = TRUE)
kable(get_eigenvalue(inca2_pca))
fviz_eig(inca2_pca)
### Analyse en sous blocs
#### Sous bloc 1 : Age, conso alcool, jour et type
inca2_bloc1 <- inca2_numerique[c(1:14,19)]
correlation_inca2_bloc1 = cor(inca2_bloc1)
corrplot(correlation_inca2_bloc1)
inca2_numerique[c(1:14,19)]
colnames(inca2_numerique)[c(1:14)]
colnames(inca2_numerique)[c(1:14)]
rm(list=ls())
library(knitr) #pour avoir un format table dans les sorties
library(ggplot2) #pour avoir de 'beaux'graphiques
library(FactoMineR) #pour effectuer l'ACP
library(factoextra) #pour extraire et visualiser les résultats issus de FactoMineR
library(tidyverse)
library(corrplot) #pour avoir une représentation des corrélations
## Import et formattage des données
inca2 <- read.csv('inca2_alcool.csv', header = TRUE)
inca2$nomen = as.factor(inca2$nomen)
inca2$sexe_ps = as.factor(inca2$sexe_ps)
levels(inca2$sexe_ps) <- c("homme", "femme")
inca2$reg = as.factor(inca2$reg)
levels(inca2$reg) <- c('Nord Ouest', 'Est', 'Ile de France',
'Ouest', 'Centre', 'Centre Est',
'Sud Ouest', 'Sud Est')
colnames(inca2)[19:54] <- c("energie_totale","proteines", "glucides_dispos",
"lipides","alcool","ag_monoinsatures",
"ag_polyinsatures", "ag_satures", "amidon",
"glucides_simples","fibres","cholesterol","eau",
"calcium", "fer", "sodium", "magnesium",
"manganese", "phosphore", "potassium",
"cuivre", "zinc", "selenium", "iode",
"retinol", "beta-carotene", "vitamineC",
"vitamineD", "vitamineE", "thiamine-B1",
"riboflavine-B2", "niacine-B3",
"acide_panthothenique-B5", "pyridoxine-B6",
"folates-B9", "colobamine-B12")
summary(inca2)
str(inca2)
conso <- read.csv(file = 'conso_alcool.csv')
conso$nomen = as.factor(conso$nomen)
conso$nomjour = as.factor(conso$nomjour)
conso$nomgr = as.factor(conso$nomgr)
summary(conso)
## Analyse en composante principale
inca2_numerique = inca2[-c(1,2,4,5)]
correlation_inca2 = cor(inca2_numerique)
corrplot(correlation_inca2)
inca2_pca = PCA(inca2_numerique, scale.unit = TRUE)
kable(get_eigenvalue(inca2_pca))
fviz_eig(inca2_pca)
### Analyse en sous blocs
#### Sous bloc 1 : Par semaine
inca2_sem <- inca2_numerique[c(1:14)]
correlation_inca2_sem = cor(inca2_sem)
corrplot(correlation_inca2_sem)
inca2_bloc1_pca = PCA(inca2_sem, scale.unit = TRUE)
inca2_sem_pca = PCA(inca2_sem, scale.unit = TRUE)
inca2_sem_pca = PCA(inca2_sem, graph = FALSE, scale.unit = TRUE)
corrplot(correlation_inca2_sem)
knitr::opts_chunk$set(echo = TRUE)
fviz_eig(inca2_sem_pca)
kable(head(get_eigenvalue(inca2_sem_pca)))
kable(get_eigenvalue(inca2_sem_pca))
